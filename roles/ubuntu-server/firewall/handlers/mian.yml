---
# Handlers para el firewall en Ubuntu Server

# ğŸ”¥ UFW: Firewall principal
- name: reload ufw
  command: ufw reload
  become: true

- name: restart ufw
  command: ufw disable && ufw enable
  become: true

# ğŸ›¡ï¸ Fail2ban (detecciÃ³n de intrusos)
- name: restart fail2ban
  systemd:
    name: fail2ban
    state: restarted
    enabled: yes
  become: true

- name: reload fail2ban
  command: fail2ban-client reload
  become: true

# ğŸ’¾ Guardar configuraciÃ³n (opcional)
- name: save firewall config
  command: ufw status numbered
  register: ufw_status
  changed_when: false
  become: true
