---
# üß© Playbook maestro para Windows
# Configura usuarios, software, mantenimiento, optimizaci√≥n y apariencia

- name: "Despliegue completo - Windows"
  hosts: windows
  gather_facts: yes
  become: no  # En Windows no se usa sudo; se manejan permisos por WinRM

  vars:
    timezone: "SA Pacific Standard Time"
    temp_clean_days: 7

  roles:
    # 1Ô∏è‚É£ Usuarios y permisos
    - role: usuarios_windows
      tags: ["usuarios"]

    # 2Ô∏è‚É£ Instalaci√≥n de software esencial
    - role: software_windows
      tags: ["software"]

    # 3Ô∏è‚É£ Optimizaci√≥n del sistema
    - role: optimizacion_windows
      tags: ["optimizacion"]

    # 4Ô∏è‚É£ Mantenimiento (limpieza, tareas programadas)
    - role: mantenimiento_windows
      tags: ["mantenimiento"]

    # 5Ô∏è‚É£ Actualizaciones autom√°ticas
    - role: actualiza_windows
      tags: ["actualizacion"]

    # 6Ô∏è‚É£ Ocultar usuarios del inicio de sesi√≥n
    - role: ocultar_usuarios_windows
      tags: ["seguridad"]

    # 7Ô∏è‚É£ Configuraci√≥n visual y personalizaci√≥n
    - role: configuracion_visual_windows
      tags: ["apariencia"]

  tasks:
    - name: "üìã Mostrar resumen de configuraci√≥n aplicada"
      win_shell: |
        Write-Host "===================================="
        Write-Host " ‚úÖ Configuraci√≥n de Windows completa"
        Write-Host "===================================="
        systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
      register: win_info
      changed_when: false

    - name: "Mostrar informaci√≥n del sistema Windows"
      debug:
        msg: "{{ win_info.stdout_lines }}"
