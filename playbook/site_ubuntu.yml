---
# üß© Playbook maestro para Ubuntu Server
# Configura seguridad, usuarios, firewall y mantenimiento b√°sico

- name: "Despliegue completo - Ubuntu Server"
  hosts: ubuntu_server
  become: yes
  gather_facts: yes

  vars:
    timezone: "America/Lima"
    selinux_state: "disabled"
    firewall_masquerade: false

  roles:
    # 1Ô∏è‚É£ Configuraci√≥n b√°sica y actualizaci√≥n del sistema
    - role: ubuntu-server/usuarios_ubuntuserver
      tags: [usuarios, users]

    # 2Ô∏è‚É£ Configuraci√≥n de usuarios y permisos
    - role: ubuntu-server/common
      tags: [common, base]

    # 3Ô∏è‚É£ Configuraci√≥n de firewall y seguridad
    - role: ubuntu-server/firewall
      tags: [firewall, security]

  tasks:
    - name: "üì¶ Verificar estado general del sistema"
      shell: |
        echo "==================================="
        echo "   ‚úÖ Ubuntu configurado con √©xito  "
        echo "==================================="
        lsb_release -a
      register: system_info
      changed_when: false

    - name: "Mostrar informaci√≥n del sistema"
      debug:
        msg: "{{ system_info.stdout_lines }}"